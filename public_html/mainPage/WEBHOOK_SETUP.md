# Настройка Webhook для web3forms

## Что сделано

1. **Создан webhook обработчик** `webhook-handler.php` который:
   - Принимает данные от web3forms
   - Отправляет их в Telegram в личку заказчику
   - Логирует все операции в `webhook-logs.txt`

2. **Использует существующие настройки Telegram**:
   - Токен бота: `7808482676:AAEM-SN7WMoy-lJlkD0LMEuDW2C_zw4AfDM`
   - Chat ID заказчика: `7501193489`

## Настройка webhook в web3forms

### Шаг 1: Войти в панель web3forms
1. Перейдите на https://web3forms.com/
2. Войдите в свой аккаунт
3. Найдите форму с access_key: `d759a276-7f88-4a85-a572-a472510fd51b`

### Шаг 2: Настроить webhook
1. В настройках формы найдите раздел "Webhooks"
2. Добавьте новый webhook со следующими параметрами:
   - **URL**: `https://ваш-домен.рф/mainPage/webhook-handler.php`
   - **Method**: `POST`
   - **Content Type**: `application/json`
   - **Status**: `Active`

### Шаг 3: Проверить настройки
1. Убедитесь, что webhook активен
2. Протестируйте отправку формы
3. Проверьте логи в `webhook-logs.txt`

## Как это работает

1. **Пользователь отправляет форму** → web3forms обрабатывает
2. **web3forms отправляет webhook** → наш обработчик получает данные
3. **Наш обработчик отправляет в Telegram** → заказчик получает уведомление

## Преимущества этого подхода

✅ **Гарантированная доставка** - web3forms повторяет запросы при ошибках
✅ **Не зависит от клиентского JavaScript** - работает даже если пользователь закроет страницу
✅ **Детальное логирование** - все операции записываются в лог
✅ **Обработка ошибок** - подробная информация об ошибках

## Мониторинг

- **Логи webhook**: `webhook-logs.txt`
- **Тестирование**: отправьте тестовую форму и проверьте логи
- **Telegram**: проверьте получение сообщений в личку

## Безопасность

- Обработчик проверяет метод запроса
- Валидирует входящие данные
- Использует htmlspecialchars для защиты от XSS
- Логирует все входящие запросы для отладки 